<!-- Loading state -->
@if (isLoading) {
  <div class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p class="loading-text">Loading your icons...</p>
  </div>
}

<!-- Error state -->
@if (error && !isLoading) {
  <div class="error-container">
    <mat-icon class="error-icon">error_outline</mat-icon>
    <p class="error-text">{{ error }}</p>
    <button class="retry-button" (click)="loadIcons()">Retry</button>
  </div>
}

<!-- Icon grid - always show when not loading and no error -->
@if (!isLoading && !error) {
  <div class="icon-grid-wrapper">
    <div class="icon-grid"
         cdkDropList
         cdkDropListOrientation="horizontal"
         [cdkDropListAutoScrollStep]="20"
         (cdkDropListDropped)="onDrop($event)"
         [@folderTransition]="animationState">

      <!-- Empty state message (shown when no icons) -->
      @if (icons.length === 0) {
        <div class="empty-message-in-grid">
          <mat-icon class="empty-icon">folder_open</mat-icon>
          <p class="empty-text">Dossier vide</p>
        </div>
      }

      <!-- Regular icons -->
      @for (icon of icons; track icon.id) {
        <div class="icon-drag-wrapper" cdkDrag [cdkDragDisabled]="!editMode">
          <app-icon-item
            [icon]="icon"
            [editMode]="editMode"
            (folderClick)="onFolderClick($event)"
            (editClick)="onEditClick($event)"
            (deleteClick)="onDeleteClick($event)"
          ></app-icon-item>
        </div>
      }

      <!-- Add new button - always visible -->
      <div class="add-new-container" (click)="onAddNewClick()">
        <div class="add-new-card">
          <mat-icon class="add-icon">add_circle_outline</mat-icon>
        </div>
        <div class="add-text">Ajouter</div>
      </div>
    </div>
  </div>
}
